!function(){var t,e={};function r(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}var n=new((t=/*#__PURE__*/function(){var t;function e(t){!function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}(this,e),this.initialState=t?t.map(function(t){return t.slice()}):Array.from({length:4},function(){return[,,,,].fill(0)}),this.board=this.initialState.map(function(t){return t.slice()}),this.score=0,this.status="idle"}return t=[{key:"moveLeft",value:function(){var t=this;if("playing"===this.status){var e=this.board.map(function(t){return t.slice()});this.board=this.board.map(function(e){for(var r=0,n=e.filter(function(t){return 0!==t}),a=0;a<n.length-1;a++)n[a]===n[a+1]&&(n[a]*=2,n[a+1]=0,r+=n[a]);t.score+=r;for(var i=n.filter(function(t){return 0!==t});i.length<4;)i.push(0);return i}),this._isBoardChanged(this.board,e)&&this._addNewNumber(this.board),this._checkGameStatus()}}},{key:"moveRight",value:function(){var t=this;if("playing"===this.status){var e=this.board.map(function(t){return t.slice()});this.board=this.board.map(function(e){for(var r=0,n=e.filter(function(t){return 0!==t}),a=n.length-1;a>0;a--)n[a]===n[a-1]&&(n[a]*=2,n[a-1]=0,r+=n[a]);t.score+=r;for(var i=n.filter(function(t){return 0!==t});i.length<4;)i.unshift(0);return i}),this._isBoardChanged(this.board,e)&&this._addNewNumber(this.board),this._checkGameStatus()}}},{key:"moveUp",value:function(){var t=this,e=function(e){var r=t.board.map(function(t){return t[e]}),n=t._compress(r);t.score+=n.score;for(var a=0;a<4;a++)t.board[a][e]=n.column[a]};if("playing"===this.status){for(var r=this.board.map(function(t){return t.slice()}),n=0;n<4;n++)e(n);this._isBoardChanged(this.board,r)&&this._addNewNumber(this.board),this._checkGameStatus()}}},{key:"moveDown",value:function(){var t=this,e=function(e){var r=t.board.map(function(t){return t[e]}).reverse(),n=t._compress(r);t.score+=n.score;for(var a=n.column.reverse(),i=0;i<4;i++)t.board[i][e]=a[i]};if("playing"===this.status){for(var r=this.board.map(function(t){return t.slice()}),n=0;n<4;n++)e(n);this._isBoardChanged(this.board,r)&&this._addNewNumber(this.board),this._checkGameStatus()}}},{key:"getScore",value:function(){return this.score}},{key:"getState",value:function(){return this.board.map(function(t){return t.slice()})}},{key:"getStatus",value:function(){return this.status}},{key:"start",value:function(){"idle"!==this.status&&(this.board=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],this.score=0,this.status="idle"),this._getEmptyCells(this.board).length>=2&&(this._addNewNumber(this.board),this._addNewNumber(this.board)),this.status="playing"}},{key:"restart",value:function(){this.board=this.initialState,this.score=0,this.status="idle"}},{key:"_getRandomEmptyCell",value:function(t){var e=Math.floor(Math.random()*t.length);return t.splice(e,1)[0]}},{key:"_compress",value:function(t){for(var e=[],r=0,n=0;n<t.length;n++)0!==t[n]&&e.push(t[n]);for(var a=0;a<e.length-1;a++)e[a]===e[a+1]&&(e[a]*=2,e[a+1]=0,r+=e[a]);for(var i=e.filter(function(t){return 0!==t});i.length<4;)i.push(0);return{column:i,score:r}}},{key:"_getEmptyCells",value:function(t){for(var e=[],r=0;r<4;r++)for(var n=0;n<4;n++)0===t[r][n]&&e.push([r,n]);return e}},{key:"_isBoardFull",value:function(t){return 0===this._getEmptyCells(t).length}},{key:"_isBoardChanged",value:function(t,e){return t.some(function(t,r){return t.some(function(t,n){return t!==e[r][n]})})}},{key:"_addNewNumber",value:function(t){var e=this._getEmptyCells(t),n=this._getRandomEmptyCell(e);if(n){var a=function(t){if(Array.isArray(t))return t}(n)||function(t,e){var r,n,a=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=a){var i=[],s=!0,o=!1;try{for(a=a.call(t);!(s=(r=a.next()).done)&&(i.push(r.value),2!==i.length);s=!0);}catch(t){o=!0,n=t}finally{try{s||null==a.return||a.return()}finally{if(o)throw n}}return i}}(n,2)||function(t,e){if(t){if("string"==typeof t)return r(t,2);var n=Object.prototype.toString.call(t).slice(8,-1);if("Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return r(t,2)}}(n,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),i=a[0],s=a[1];t[i][s]=.9>Math.random()?2:4}}},{key:"_checkGameStatus",value:function(){var t=this.board.flat();if(t.includes(2048)){this.status="win";return}if(!t.includes(0)){for(var e=0;e<4;e++)for(var r=0;r<4;r++){var n=this.board[e][r];if(r<3&&n===this.board[e][r+1]||e<3&&n===this.board[e+1][r])return}this.status="lose"}}}],function(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}(e.prototype,t),e}())&&t.__esModule?t.default:t),a=document.querySelector(".start");function i(t){for(var e=document.querySelectorAll(".field-cell"),r=0,n=0;n<4;n++)for(var a=0;a<4;a++){var i=t[n][a],s=e[r];s.textContent=0===i?"":i,s.className="field-cell",0!==i&&s.classList.add("field-cell--".concat(i)),r++}}function s(t){var e=document.querySelector(".message-start"),r=document.querySelector(".message-win"),n=document.querySelector(".message-lose");switch(e.classList.add("hidden"),r.classList.add("hidden"),n.classList.add("hidden"),t){case"idle":e.classList.remove("hidden");break;case"win":r.classList.remove("hidden");break;case"lose":n.classList.remove("hidden")}}a.addEventListener("click",function(){n.start(),i(n.getState()),a.className="button restart",a.textContent="Restart",s(n.getStatus())}),document.addEventListener("keydown",function(t){var e;switch(t.key){case"ArrowUp":n.moveUp();break;case"ArrowDown":n.moveDown();break;case"ArrowLeft":n.moveLeft();break;case"ArrowRight":n.moveRight()}i(n.getState()),e=n.getScore(),document.querySelector(".game-score").textContent=e,s(n.getStatus())})}();
//# sourceMappingURL=index.be90cf1b.js.map
