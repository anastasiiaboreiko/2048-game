{"mappings":"A,I,E,E,C,ECKA,MAAM,EAAO,G,C,C,ECEb,MAeE,YAAY,CAAY,CAAE,CAExB,IAAI,CAAC,YAAY,CAAG,EAChB,EAAa,GAAG,CAAC,AAAC,GAAQ,EAAI,KAAK,IACnC,MAAM,IAAI,CAAC,CAAE,OAAQ,CAAE,EAAG,IAAM,MAAM,CAAG,IAAI,CAAC,IAElD,IAAI,CAAC,KAAK,CAAG,IAAI,CAAC,YAAY,CAAC,GAAG,CAAC,AAAC,GAAQ,EAAI,KAAK,IAErD,IAAI,CAAC,KAAK,CAAG,EACb,IAAI,CAAC,MAAM,CAAG,MAChB,CAEA,UAAW,CACT,GAAI,AAAgB,YAAhB,IAAI,CAAC,MAAM,CACb,OAGF,IAAM,EAAW,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,AAAC,GAAQ,EAAI,KAAK,GAElD,CAAA,IAAI,CAAC,KAAK,CAAG,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,AAAC,IAC3B,IAAI,EAAS,EACP,EAAW,EAAI,MAAM,CAAC,AAAC,GAAM,AAAM,IAAN,GAEnC,IAAK,IAAI,EAAI,EAAG,EAAI,EAAS,MAAM,CAAG,EAAG,IACnC,CAAQ,CAAC,EAAE,GAAK,CAAQ,CAAC,EAAI,EAAE,GACjC,CAAQ,CAAC,EAAE,EAAI,EACf,CAAQ,CAAC,EAAI,EAAE,CAAG,EAClB,GAAU,CAAQ,CAAC,EAAE,CAIzB,CAAA,IAAI,CAAC,KAAK,EAAI,EAEd,IAAM,EAAS,EAAS,MAAM,CAAC,AAAC,GAAM,AAAM,IAAN,GAEtC,KAAO,EAAO,MAAM,CAAG,GACrB,EAAO,IAAI,CAAC,GAGd,OAAO,CACT,GAEI,IAAI,CAAC,eAAe,CAAC,IAAI,CAAC,KAAK,CAAE,IACnC,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC,KAAK,EAG/B,IAAI,CAAC,gBAAgB,EACvB,CAEA,WAAY,CACV,GAAI,AAAgB,YAAhB,IAAI,CAAC,MAAM,CACb,OAGF,IAAM,EAAW,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,AAAC,GAAQ,EAAI,KAAK,GAElD,CAAA,IAAI,CAAC,KAAK,CAAG,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,AAAC,IAC3B,IAAI,EAAS,EACP,EAAW,EAAI,MAAM,CAAC,AAAC,GAAM,AAAM,IAAN,GAEnC,IAAK,IAAI,EAAI,EAAS,MAAM,CAAG,EAAG,EAAI,EAAG,IACnC,CAAQ,CAAC,EAAE,GAAK,CAAQ,CAAC,EAAI,EAAE,GACjC,CAAQ,CAAC,EAAE,EAAI,EACf,CAAQ,CAAC,EAAI,EAAE,CAAG,EAClB,GAAU,CAAQ,CAAC,EAAE,CAIzB,CAAA,IAAI,CAAC,KAAK,EAAI,EAEd,IAAM,EAAS,EAAS,MAAM,CAAC,AAAC,GAAM,AAAM,IAAN,GAEtC,KAAO,EAAO,MAAM,CAAG,GACrB,EAAO,OAAO,CAAC,GAGjB,OAAO,CACT,GAEI,IAAI,CAAC,eAAe,CAAC,IAAI,CAAC,KAAK,CAAE,IACnC,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC,KAAK,EAG/B,IAAI,CAAC,gBAAgB,EACvB,CAEA,QAAS,CACP,GAAI,AAAgB,YAAhB,IAAI,CAAC,MAAM,CACb,OAGF,IAAM,EAAW,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,AAAC,GAAQ,EAAI,KAAK,IAElD,IAAK,IAAI,EAAM,EAAG,EAAM,EAAG,IAAO,CAChC,IAAM,EAAS,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,AAAC,GAAQ,CAAG,CAAC,EAAI,EACzC,EAAgB,IAAI,CAAC,SAAS,CAAC,EAErC,CAAA,IAAI,CAAC,KAAK,EAAI,EAAc,KAAK,CAEjC,IAAK,IAAI,EAAM,EAAG,EAAM,EAAG,IACzB,IAAI,CAAC,KAAK,CAAC,EAAI,CAAC,EAAI,CAAG,EAAc,MAAM,CAAC,EAAI,AAEpD,CAEI,IAAI,CAAC,eAAe,CAAC,IAAI,CAAC,KAAK,CAAE,IACnC,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC,KAAK,EAG/B,IAAI,CAAC,gBAAgB,EACvB,CAEA,UAAW,CACT,GAAI,AAAgB,YAAhB,IAAI,CAAC,MAAM,CACb,OAGF,IAAM,EAAW,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,AAAC,GAAQ,EAAI,KAAK,IAElD,IAAK,IAAI,EAAM,EAAG,EAAM,EAAG,IAAO,CAChC,IAAM,EAAS,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,AAAC,GAAQ,CAAG,CAAC,EAAI,EAAE,OAAO,GAClD,EAAgB,IAAI,CAAC,SAAS,CAAC,EAErC,CAAA,IAAI,CAAC,KAAK,EAAI,EAAc,KAAK,CAEjC,IAAM,EAAc,EAAc,MAAM,CAAC,OAAO,GAEhD,IAAK,IAAI,EAAM,EAAG,EAAM,EAAG,IACzB,IAAI,CAAC,KAAK,CAAC,EAAI,CAAC,EAAI,CAAG,CAAW,CAAC,EAAI,AAE3C,CAEI,IAAI,CAAC,eAAe,CAAC,IAAI,CAAC,KAAK,CAAE,IACnC,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC,KAAK,EAG/B,IAAI,CAAC,gBAAgB,EACvB,CAKA,UAAW,CACT,OAAO,IAAI,CAAC,KAAK,AACnB,CAKA,UAAW,CACT,OAAO,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,AAAC,GAAQ,EAAI,KAAK,GAC1C,CAYA,WAAY,CACV,OAAO,IAAI,CAAC,MAAM,AACpB,CAKA,OAAQ,CACc,SAAhB,IAAI,CAAC,MAAM,GACb,IAAI,CAAC,KAAK,CAAG,CACX,CAAC,EAAG,EAAG,EAAG,EAAE,CACZ,CAAC,EAAG,EAAG,EAAG,EAAE,CACZ,CAAC,EAAG,EAAG,EAAG,EAAE,CACZ,CAAC,EAAG,EAAG,EAAG,EAAE,CACb,CAED,IAAI,CAAC,KAAK,CAAG,EACb,IAAI,CAAC,MAAM,CAAG,QAKZ,AAFe,IAAI,CAAC,cAAc,CAAC,IAAI,CAAC,KAAK,EAElC,MAAM,EAAI,IACvB,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC,KAAK,EAC7B,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC,KAAK,GAE/B,IAAI,CAAC,MAAM,CAAG,SAChB,CAKA,SAAU,CACR,IAAI,CAAC,KAAK,CAAG,IAAI,CAAC,YAAY,CAC9B,IAAI,CAAC,KAAK,CAAG,EACb,IAAI,CAAC,MAAM,CAAG,MAChB,CAEA,oBAAoB,CAAK,CAAE,CACzB,IAAM,EAAQ,KAAK,KAAK,CAAC,KAAK,MAAM,GAAK,EAAM,MAAM,EAErD,OAAO,EAAM,MAAM,CAAC,EAAO,EAAE,CAAC,EAAE,AAClC,CAEA,UAAU,CAAM,CAAE,CAChB,IAAM,EAAc,EAAE,CAClB,EAAS,EAEb,IAAK,IAAI,EAAI,EAAG,EAAI,EAAO,MAAM,CAAE,IACf,IAAd,CAAM,CAAC,EAAE,EACX,EAAY,IAAI,CAAC,CAAM,CAAC,EAAE,EAI9B,IAAK,IAAI,EAAI,EAAG,EAAI,EAAY,MAAM,CAAG,EAAG,IACtC,CAAW,CAAC,EAAE,GAAK,CAAW,CAAC,EAAI,EAAE,GACvC,CAAW,CAAC,EAAE,EAAI,EAClB,CAAW,CAAC,EAAI,EAAE,CAAG,EACrB,GAAU,CAAW,CAAC,EAAE,EAI5B,IAAM,EAAS,EAAY,MAAM,CAAC,AAAC,GAAM,AAAM,IAAN,GAEzC,KAAO,EAAO,MAAM,CAAG,GACrB,EAAO,IAAI,CAAC,GAGd,MAAO,CAAE,OAAQ,EAAQ,MAAO,CAAO,CACzC,CAEA,eAAe,CAAK,CAAE,CACpB,IAAM,EAAa,EAAE,CAErB,IAAK,IAAI,EAAM,EAAG,EAAM,EAAG,IACzB,IAAK,IAAI,EAAM,EAAG,EAAM,EAAG,IACD,IAApB,CAAK,CAAC,EAAI,CAAC,EAAI,EACjB,EAAW,IAAI,CAAC,CAAC,EAAK,EAAI,EAKhC,OAAO,CACT,CAEA,aAAa,CAAK,CAAE,CAClB,OAAO,AAAsC,IAAtC,IAAI,CAAC,cAAc,CAAC,GAAO,MAAM,AAC1C,CAEA,gBAAgB,CAAQ,CAAE,CAAQ,CAAE,CAClC,OAAO,EAAS,IAAI,CAAC,CAAC,EAAK,IAClB,EAAI,IAAI,CAAC,CAAC,EAAM,IACd,IAAS,CAAQ,CAAC,EAAS,CAAC,EAAS,EAGlD,CAEA,cAAc,CAAK,CAAE,CACnB,IAAM,EAAa,IAAI,CAAC,cAAc,CAAC,GACjC,EAAY,IAAI,CAAC,mBAAmB,CAAC,GAE3C,GAAI,EAAW,CACb,GAAM,CAAC,EAAM,EAAK,CAAG,CAErB,CAAA,CAAK,CAAC,EAAK,CAAC,EAAK,CAAG,AAAgB,GAAhB,KAAK,MAAM,GAAW,EAAI,CAChD,CACF,CAEA,kBAAmB,CACjB,IAAM,EAAY,IAAI,CAAC,KAAK,CAAC,IAAI,GAEjC,GAAI,EAAU,QAAQ,CAAC,MAAO,CAC5B,IAAI,CAAC,MAAM,CAAG,MAEd,MACF,CAEA,IAAI,EAAU,QAAQ,CAAC,IAIvB,IAAK,IAAI,EAAM,EAAG,EAAM,EAAG,IACzB,IAAK,IAAI,EAAM,EAAG,EAAM,EAAG,IAAO,CAChC,IAAM,EAAU,IAAI,CAAC,KAAK,CAAC,EAAI,CAAC,EAAI,CAEpC,GAAI,EAAM,GAAK,IAAY,IAAI,CAAC,KAAK,CAAC,EAAI,CAAC,EAAM,EAAE,EAI/C,EAAM,GAAK,IAAY,IAAI,CAAC,KAAK,CAAC,EAAM,EAAE,CAAC,EAAI,CAHjD,MAMJ,CAGF,IAAI,CAAC,MAAM,CAAG,OAChB,CACF,G,U,C,E,O,C,C,EDxTM,EAAc,SAAS,aAAa,CAAC,UAiC3C,SAAS,EAAY,CAAK,EACxB,IAAM,EAAQ,SAAS,gBAAgB,CAAC,eACpC,EAAQ,EAEZ,IAAK,IAAI,EAAM,EAAG,EAAM,EAAG,IACzB,IAAK,IAAI,EAAM,EAAG,EAAM,EAAG,IAAO,CAChC,IAAM,EAAQ,CAAK,CAAC,EAAI,CAAC,EAAI,CACvB,EAAO,CAAK,CAAC,EAAM,AAEzB,CAAA,EAAK,WAAW,CAAG,AAAU,IAAV,EAAc,GAAK,EACtC,EAAK,SAAS,CAAG,aAEH,IAAV,GACF,EAAK,SAAS,CAAC,GAAG,CAAC,CAAC,YAAY,EAAE,EAAM,CAAC,EAG3C,GACF,CAEJ,CAQA,SAAS,EAAc,CAAU,EAC/B,IAAM,EAAe,SAAS,aAAa,CAAC,kBACtC,EAAa,SAAS,aAAa,CAAC,gBACpC,EAAc,SAAS,aAAa,CAAC,iBAM3C,OAJA,EAAa,SAAS,CAAC,GAAG,CAAC,UAC3B,EAAW,SAAS,CAAC,GAAG,CAAC,UACzB,EAAY,SAAS,CAAC,GAAG,CAAC,UAElB,GACN,IAAK,OACH,EAAa,SAAS,CAAC,MAAM,CAAC,UAC9B,KACF,KAAK,MACH,EAAW,SAAS,CAAC,MAAM,CAAC,UAC5B,KACF,KAAK,OACH,EAAY,SAAS,CAAC,MAAM,CAAC,SAIjC,CACF,CAhFA,EAAY,gBAAgB,CAAC,QAAS,KACpC,EAAK,KAAK,GACV,EAAY,EAAK,QAAQ,IACzB,EAAY,SAAS,CAAG,iBACxB,EAAY,WAAW,CAAG,UAC1B,EAAc,EAAK,SAAS,GAC9B,GAEA,SAAS,gBAAgB,CAAC,UAAW,AAAC,QA4CjB,EA3CnB,OAAQ,EAAE,GAAG,EACX,IAAK,UACH,EAAK,MAAM,GACX,KACF,KAAK,YACH,EAAK,QAAQ,GACb,KACF,KAAK,YACH,EAAK,QAAQ,GACb,KACF,KAAK,aACH,EAAK,SAAS,EAIlB,CAEA,EAAY,EAAK,QAAQ,IA0BN,EAzBP,EAAK,QAAQ,GA4BzB,AAFc,SAAS,aAAa,CAAC,eAE/B,WAAW,CAAG,EA3BpB,EAAc,EAAK,SAAS,GAC9B","sources":["<anon>","src/scripts/main.js","src/modules/Game.class.js"],"sourcesContent":["\nfunction $parcel$interopDefault(a) {\n  return a && a.__esModule ? a.default : a;\n}\nvar $a5fd07fa01589658$exports = {};\n\"use strict\";\n/**\n * This class represents the game.\n * Now it has a basic structure, that is needed for testing.\n * Feel free to add more props and methods if needed.\n */ class $a5fd07fa01589658$var$Game {\n    /**\n   * Creates a new game instance.\n   *\n   * @param {number[][]} initialState\n   * The initial state of the board.\n   * @default\n   * [[0, 0, 0, 0],\n   *  [0, 0, 0, 0],\n   *  [0, 0, 0, 0],\n   *  [0, 0, 0, 0]]\n   *\n   * If passed, the board will be initialized with the provided\n   * initial state.\n   */ constructor(initialState){\n        // eslint-disable-next-line no-console\n        this.initialState = initialState ? initialState.map((row)=>row.slice()) : Array.from({\n            length: 4\n        }, ()=>Array(4).fill(0));\n        this.board = this.initialState.map((row)=>row.slice());\n        this.score = 0;\n        this.status = \"idle\";\n    }\n    moveLeft() {\n        if (this.status !== \"playing\") return;\n        const oldBoard = this.board.map((row)=>row.slice());\n        this.board = this.board.map((row)=>{\n            let gained = 0;\n            const clearRow = row.filter((v)=>v !== 0);\n            for(let r = 0; r < clearRow.length - 1; r++)if (clearRow[r] === clearRow[r + 1]) {\n                clearRow[r] *= 2;\n                clearRow[r + 1] = 0;\n                gained += clearRow[r];\n            }\n            this.score += gained;\n            const result = clearRow.filter((v)=>v !== 0);\n            while(result.length < 4)result.push(0);\n            return result;\n        });\n        if (this._isBoardChanged(this.board, oldBoard)) this._addNewNumber(this.board);\n        this._checkGameStatus();\n    }\n    moveRight() {\n        if (this.status !== \"playing\") return;\n        const oldBoard = this.board.map((row)=>row.slice());\n        this.board = this.board.map((row)=>{\n            let gained = 0;\n            const clearRow = row.filter((v)=>v !== 0);\n            for(let r = clearRow.length - 1; r > 0; r--)if (clearRow[r] === clearRow[r - 1]) {\n                clearRow[r] *= 2;\n                clearRow[r - 1] = 0;\n                gained += clearRow[r];\n            }\n            this.score += gained;\n            const result = clearRow.filter((v)=>v !== 0);\n            while(result.length < 4)result.unshift(0);\n            return result;\n        });\n        if (this._isBoardChanged(this.board, oldBoard)) this._addNewNumber(this.board);\n        this._checkGameStatus();\n    }\n    moveUp() {\n        if (this.status !== \"playing\") return;\n        const oldBoard = this.board.map((row)=>row.slice());\n        for(let col = 0; col < 4; col++){\n            const column = this.board.map((row)=>row[col]);\n            const compressedCol = this._compress(column);\n            this.score += compressedCol.score;\n            for(let row = 0; row < 4; row++)this.board[row][col] = compressedCol.column[row];\n        }\n        if (this._isBoardChanged(this.board, oldBoard)) this._addNewNumber(this.board);\n        this._checkGameStatus();\n    }\n    moveDown() {\n        if (this.status !== \"playing\") return;\n        const oldBoard = this.board.map((row)=>row.slice());\n        for(let col = 0; col < 4; col++){\n            const column = this.board.map((row)=>row[col]).reverse();\n            const compressedCol = this._compress(column);\n            this.score += compressedCol.score;\n            const finalColumn = compressedCol.column.reverse();\n            for(let row = 0; row < 4; row++)this.board[row][col] = finalColumn[row];\n        }\n        if (this._isBoardChanged(this.board, oldBoard)) this._addNewNumber(this.board);\n        this._checkGameStatus();\n    }\n    /**\n   * @returns {number}\n   */ getScore() {\n        return this.score;\n    }\n    /**\n   * @returns {number[][]}\n   */ getState() {\n        return this.board.map((row)=>row.slice());\n    }\n    /**\n   * Returns the current game status.\n   *\n   * @returns {string} One of: 'idle', 'playing', 'win', 'lose'\n   *\n   * `idle` - the game has not started yet (the initial state);\n   * `playing` - the game is in progress;\n   * `win` - the game is won;\n   * `lose` - the game is lost\n   */ getStatus() {\n        return this.status;\n    }\n    /**\n   * Starts the game.\n   */ start() {\n        if (this.status !== \"idle\") {\n            this.board = [\n                [\n                    0,\n                    0,\n                    0,\n                    0\n                ],\n                [\n                    0,\n                    0,\n                    0,\n                    0\n                ],\n                [\n                    0,\n                    0,\n                    0,\n                    0\n                ],\n                [\n                    0,\n                    0,\n                    0,\n                    0\n                ]\n            ];\n            this.score = 0;\n            this.status = \"idle\";\n        }\n        const emptyCells = this._getEmptyCells(this.board);\n        if (emptyCells.length >= 2) {\n            this._addNewNumber(this.board);\n            this._addNewNumber(this.board);\n        }\n        this.status = \"playing\";\n    }\n    /**\n   * Resets the game.\n   */ restart() {\n        this.board = this.initialState;\n        this.score = 0;\n        this.status = \"idle\";\n    }\n    _getRandomEmptyCell(cells) {\n        const index = Math.floor(Math.random() * cells.length);\n        return cells.splice(index, 1)[0];\n    }\n    _compress(column) {\n        const clearColumn = [];\n        let gained = 0;\n        for(let i = 0; i < column.length; i++)if (column[i] !== 0) clearColumn.push(column[i]);\n        for(let y = 0; y < clearColumn.length - 1; y++)if (clearColumn[y] === clearColumn[y + 1]) {\n            clearColumn[y] *= 2;\n            clearColumn[y + 1] = 0;\n            gained += clearColumn[y];\n        }\n        const result = clearColumn.filter((v)=>v !== 0);\n        while(result.length < 4)result.push(0);\n        return {\n            column: result,\n            score: gained\n        };\n    }\n    _getEmptyCells(board) {\n        const emptyCells = [];\n        for(let row = 0; row < 4; row++){\n            for(let col = 0; col < 4; col++)if (board[row][col] === 0) emptyCells.push([\n                row,\n                col\n            ]);\n        }\n        return emptyCells;\n    }\n    _isBoardFull(board) {\n        return this._getEmptyCells(board).length === 0;\n    }\n    _isBoardChanged(newBoard, oldBoard) {\n        return newBoard.some((row, rowIndex)=>{\n            return row.some((cell, colIndex)=>{\n                return cell !== oldBoard[rowIndex][colIndex];\n            });\n        });\n    }\n    _addNewNumber(board) {\n        const emptyCells = this._getEmptyCells(board);\n        const newNumber = this._getRandomEmptyCell(emptyCells);\n        if (newNumber) {\n            const [row1, col1] = newNumber;\n            board[row1][col1] = Math.random() < 0.9 ? 2 : 4;\n        }\n    }\n    _checkGameStatus() {\n        const flatBoard = this.board.flat();\n        if (flatBoard.includes(2048)) {\n            this.status = \"win\";\n            return;\n        }\n        if (flatBoard.includes(0)) return;\n        for(let row = 0; row < 4; row++)for(let col = 0; col < 4; col++){\n            const current = this.board[row][col];\n            if (col < 3 && current === this.board[row][col + 1]) return;\n            if (row < 3 && current === this.board[row + 1][col]) return;\n        }\n        this.status = \"lose\";\n    }\n}\n$a5fd07fa01589658$exports = $a5fd07fa01589658$var$Game;\n\n\n\"use strict\";\nconst $09e991522ca7e64e$var$game = new (0, (/*@__PURE__*/$parcel$interopDefault($a5fd07fa01589658$exports)))();\n// Write your code here\nconst $09e991522ca7e64e$var$startButton = document.querySelector(\".start\");\n$09e991522ca7e64e$var$startButton.addEventListener(\"click\", ()=>{\n    $09e991522ca7e64e$var$game.start();\n    $09e991522ca7e64e$var$renderBoard($09e991522ca7e64e$var$game.getState());\n    $09e991522ca7e64e$var$startButton.className = \"button restart\";\n    $09e991522ca7e64e$var$startButton.textContent = \"Restart\";\n    $09e991522ca7e64e$var$updateMessage($09e991522ca7e64e$var$game.getStatus());\n});\ndocument.addEventListener(\"keydown\", (e)=>{\n    switch(e.key){\n        case \"ArrowUp\":\n            $09e991522ca7e64e$var$game.moveUp();\n            break;\n        case \"ArrowDown\":\n            $09e991522ca7e64e$var$game.moveDown();\n            break;\n        case \"ArrowLeft\":\n            $09e991522ca7e64e$var$game.moveLeft();\n            break;\n        case \"ArrowRight\":\n            $09e991522ca7e64e$var$game.moveRight();\n            break;\n        default:\n            break;\n    }\n    $09e991522ca7e64e$var$renderBoard($09e991522ca7e64e$var$game.getState());\n    $09e991522ca7e64e$var$updateScore($09e991522ca7e64e$var$game.getScore());\n    $09e991522ca7e64e$var$updateMessage($09e991522ca7e64e$var$game.getStatus());\n});\nfunction $09e991522ca7e64e$var$renderBoard(state) {\n    const cells = document.querySelectorAll(\".field-cell\");\n    let index = 0;\n    for(let row = 0; row < 4; row++)for(let col = 0; col < 4; col++){\n        const value = state[row][col];\n        const cell = cells[index];\n        cell.textContent = value === 0 ? \"\" : value;\n        cell.className = \"field-cell\";\n        if (value !== 0) cell.classList.add(`field-cell--${value}`);\n        index++;\n    }\n}\nfunction $09e991522ca7e64e$var$updateScore(scores) {\n    const score = document.querySelector(\".game-score\");\n    score.textContent = scores;\n}\nfunction $09e991522ca7e64e$var$updateMessage(gameStatus) {\n    const startMessage = document.querySelector(\".message-start\");\n    const winMessage = document.querySelector(\".message-win\");\n    const loseMessage = document.querySelector(\".message-lose\");\n    startMessage.classList.add(\"hidden\");\n    winMessage.classList.add(\"hidden\");\n    loseMessage.classList.add(\"hidden\");\n    switch(gameStatus){\n        case \"idle\":\n            startMessage.classList.remove(\"hidden\");\n            break;\n        case \"win\":\n            winMessage.classList.remove(\"hidden\");\n            break;\n        case \"lose\":\n            loseMessage.classList.remove(\"hidden\");\n            break;\n        default:\n            break;\n    }\n}\n\n\n//# sourceMappingURL=index.4582e200.js.map\n","'use strict';\n\n// Uncomment the next lines to use your game instance in the browser\nimport Game from '../modules/Game.class.js';\n\nconst game = new Game();\n\n// Write your code here\n\nconst startButton = document.querySelector('.start');\n\nstartButton.addEventListener('click', () => {\n  game.start();\n  renderBoard(game.getState());\n  startButton.className = 'button restart';\n  startButton.textContent = 'Restart';\n  updateMessage(game.getStatus());\n});\n\ndocument.addEventListener('keydown', (e) => {\n  switch (e.key) {\n    case 'ArrowUp':\n      game.moveUp();\n      break;\n    case 'ArrowDown':\n      game.moveDown();\n      break;\n    case 'ArrowLeft':\n      game.moveLeft();\n      break;\n    case 'ArrowRight':\n      game.moveRight();\n      break;\n    default:\n      break;\n  }\n\n  renderBoard(game.getState());\n  updateScore(game.getScore());\n  updateMessage(game.getStatus());\n});\n\nfunction renderBoard(state) {\n  const cells = document.querySelectorAll('.field-cell');\n  let index = 0;\n\n  for (let row = 0; row < 4; row++) {\n    for (let col = 0; col < 4; col++) {\n      const value = state[row][col];\n      const cell = cells[index];\n\n      cell.textContent = value === 0 ? '' : value;\n      cell.className = 'field-cell';\n\n      if (value !== 0) {\n        cell.classList.add(`field-cell--${value}`);\n      }\n\n      index++;\n    }\n  }\n}\n\nfunction updateScore(scores) {\n  const score = document.querySelector('.game-score');\n\n  score.textContent = scores;\n}\n\nfunction updateMessage(gameStatus) {\n  const startMessage = document.querySelector('.message-start');\n  const winMessage = document.querySelector('.message-win');\n  const loseMessage = document.querySelector('.message-lose');\n\n  startMessage.classList.add('hidden');\n  winMessage.classList.add('hidden');\n  loseMessage.classList.add('hidden');\n\n  switch (gameStatus) {\n    case 'idle':\n      startMessage.classList.remove('hidden');\n      break;\n    case 'win':\n      winMessage.classList.remove('hidden');\n      break;\n    case 'lose':\n      loseMessage.classList.remove('hidden');\n      break;\n    default:\n      break;\n  }\n}\n","'use strict';\n\n/**\n * This class represents the game.\n * Now it has a basic structure, that is needed for testing.\n * Feel free to add more props and methods if needed.\n */\nclass Game {\n  /**\n   * Creates a new game instance.\n   *\n   * @param {number[][]} initialState\n   * The initial state of the board.\n   * @default\n   * [[0, 0, 0, 0],\n   *  [0, 0, 0, 0],\n   *  [0, 0, 0, 0],\n   *  [0, 0, 0, 0]]\n   *\n   * If passed, the board will be initialized with the provided\n   * initial state.\n   */\n  constructor(initialState) {\n    // eslint-disable-next-line no-console\n    this.initialState = initialState\n      ? initialState.map((row) => row.slice())\n      : Array.from({ length: 4 }, () => Array(4).fill(0));\n\n    this.board = this.initialState.map((row) => row.slice());\n\n    this.score = 0;\n    this.status = 'idle';\n  }\n\n  moveLeft() {\n    if (this.status !== 'playing') {\n      return;\n    }\n\n    const oldBoard = this.board.map((row) => row.slice());\n\n    this.board = this.board.map((row) => {\n      let gained = 0;\n      const clearRow = row.filter((v) => v !== 0);\n\n      for (let r = 0; r < clearRow.length - 1; r++) {\n        if (clearRow[r] === clearRow[r + 1]) {\n          clearRow[r] *= 2;\n          clearRow[r + 1] = 0;\n          gained += clearRow[r];\n        }\n      }\n\n      this.score += gained;\n\n      const result = clearRow.filter((v) => v !== 0);\n\n      while (result.length < 4) {\n        result.push(0);\n      }\n\n      return result;\n    });\n\n    if (this._isBoardChanged(this.board, oldBoard)) {\n      this._addNewNumber(this.board);\n    }\n\n    this._checkGameStatus();\n  }\n\n  moveRight() {\n    if (this.status !== 'playing') {\n      return;\n    }\n\n    const oldBoard = this.board.map((row) => row.slice());\n\n    this.board = this.board.map((row) => {\n      let gained = 0;\n      const clearRow = row.filter((v) => v !== 0);\n\n      for (let r = clearRow.length - 1; r > 0; r--) {\n        if (clearRow[r] === clearRow[r - 1]) {\n          clearRow[r] *= 2;\n          clearRow[r - 1] = 0;\n          gained += clearRow[r];\n        }\n      }\n\n      this.score += gained;\n\n      const result = clearRow.filter((v) => v !== 0);\n\n      while (result.length < 4) {\n        result.unshift(0);\n      }\n\n      return result;\n    });\n\n    if (this._isBoardChanged(this.board, oldBoard)) {\n      this._addNewNumber(this.board);\n    }\n\n    this._checkGameStatus();\n  }\n\n  moveUp() {\n    if (this.status !== 'playing') {\n      return;\n    }\n\n    const oldBoard = this.board.map((row) => row.slice());\n\n    for (let col = 0; col < 4; col++) {\n      const column = this.board.map((row) => row[col]);\n      const compressedCol = this._compress(column);\n\n      this.score += compressedCol.score;\n\n      for (let row = 0; row < 4; row++) {\n        this.board[row][col] = compressedCol.column[row];\n      }\n    }\n\n    if (this._isBoardChanged(this.board, oldBoard)) {\n      this._addNewNumber(this.board);\n    }\n\n    this._checkGameStatus();\n  }\n\n  moveDown() {\n    if (this.status !== 'playing') {\n      return;\n    }\n\n    const oldBoard = this.board.map((row) => row.slice());\n\n    for (let col = 0; col < 4; col++) {\n      const column = this.board.map((row) => row[col]).reverse();\n      const compressedCol = this._compress(column);\n\n      this.score += compressedCol.score;\n\n      const finalColumn = compressedCol.column.reverse();\n\n      for (let row = 0; row < 4; row++) {\n        this.board[row][col] = finalColumn[row];\n      }\n    }\n\n    if (this._isBoardChanged(this.board, oldBoard)) {\n      this._addNewNumber(this.board);\n    }\n\n    this._checkGameStatus();\n  }\n\n  /**\n   * @returns {number}\n   */\n  getScore() {\n    return this.score;\n  }\n\n  /**\n   * @returns {number[][]}\n   */\n  getState() {\n    return this.board.map((row) => row.slice());\n  }\n\n  /**\n   * Returns the current game status.\n   *\n   * @returns {string} One of: 'idle', 'playing', 'win', 'lose'\n   *\n   * `idle` - the game has not started yet (the initial state);\n   * `playing` - the game is in progress;\n   * `win` - the game is won;\n   * `lose` - the game is lost\n   */\n  getStatus() {\n    return this.status;\n  }\n\n  /**\n   * Starts the game.\n   */\n  start() {\n    if (this.status !== 'idle') {\n      this.board = [\n        [0, 0, 0, 0],\n        [0, 0, 0, 0],\n        [0, 0, 0, 0],\n        [0, 0, 0, 0],\n      ];\n\n      this.score = 0;\n      this.status = 'idle';\n    }\n\n    const emptyCells = this._getEmptyCells(this.board);\n\n    if (emptyCells.length >= 2) {\n      this._addNewNumber(this.board);\n      this._addNewNumber(this.board);\n    }\n    this.status = 'playing';\n  }\n\n  /**\n   * Resets the game.\n   */\n  restart() {\n    this.board = this.initialState;\n    this.score = 0;\n    this.status = 'idle';\n  }\n\n  _getRandomEmptyCell(cells) {\n    const index = Math.floor(Math.random() * cells.length);\n\n    return cells.splice(index, 1)[0];\n  }\n\n  _compress(column) {\n    const clearColumn = [];\n    let gained = 0;\n\n    for (let i = 0; i < column.length; i++) {\n      if (column[i] !== 0) {\n        clearColumn.push(column[i]);\n      }\n    }\n\n    for (let y = 0; y < clearColumn.length - 1; y++) {\n      if (clearColumn[y] === clearColumn[y + 1]) {\n        clearColumn[y] *= 2;\n        clearColumn[y + 1] = 0;\n        gained += clearColumn[y];\n      }\n    }\n\n    const result = clearColumn.filter((v) => v !== 0);\n\n    while (result.length < 4) {\n      result.push(0);\n    }\n\n    return { column: result, score: gained };\n  }\n\n  _getEmptyCells(board) {\n    const emptyCells = [];\n\n    for (let row = 0; row < 4; row++) {\n      for (let col = 0; col < 4; col++) {\n        if (board[row][col] === 0) {\n          emptyCells.push([row, col]);\n        }\n      }\n    }\n\n    return emptyCells;\n  }\n\n  _isBoardFull(board) {\n    return this._getEmptyCells(board).length === 0;\n  }\n\n  _isBoardChanged(newBoard, oldBoard) {\n    return newBoard.some((row, rowIndex) => {\n      return row.some((cell, colIndex) => {\n        return cell !== oldBoard[rowIndex][colIndex];\n      });\n    });\n  }\n\n  _addNewNumber(board) {\n    const emptyCells = this._getEmptyCells(board);\n    const newNumber = this._getRandomEmptyCell(emptyCells);\n\n    if (newNumber) {\n      const [row1, col1] = newNumber;\n\n      board[row1][col1] = Math.random() < 0.9 ? 2 : 4;\n    }\n  }\n\n  _checkGameStatus() {\n    const flatBoard = this.board.flat();\n\n    if (flatBoard.includes(2048)) {\n      this.status = 'win';\n\n      return;\n    }\n\n    if (flatBoard.includes(0)) {\n      return;\n    }\n\n    for (let row = 0; row < 4; row++) {\n      for (let col = 0; col < 4; col++) {\n        const current = this.board[row][col];\n\n        if (col < 3 && current === this.board[row][col + 1]) {\n          return;\n        }\n\n        if (row < 3 && current === this.board[row + 1][col]) {\n          return;\n        }\n      }\n    }\n\n    this.status = 'lose';\n  }\n}\n\nmodule.exports = Game;\n"],"names":["a","$a5fd07fa01589658$exports","$09e991522ca7e64e$var$game","constructor","initialState","map","row","slice","Array","from","length","fill","board","score","status","moveLeft","oldBoard","gained","clearRow","filter","v","r","result","push","_isBoardChanged","_addNewNumber","_checkGameStatus","moveRight","unshift","moveUp","col","column","compressedCol","_compress","moveDown","reverse","finalColumn","getScore","getState","getStatus","start","emptyCells","_getEmptyCells","restart","_getRandomEmptyCell","cells","index","Math","floor","random","splice","clearColumn","i","y","_isBoardFull","newBoard","some","rowIndex","cell","colIndex","newNumber","row1","col1","flatBoard","flat","includes","current","__esModule","default","$09e991522ca7e64e$var$startButton","document","querySelector","$09e991522ca7e64e$var$renderBoard","state","querySelectorAll","value","textContent","className","classList","add","$09e991522ca7e64e$var$updateMessage","gameStatus","startMessage","winMessage","loseMessage","remove","addEventListener","e","scores","key"],"version":3,"file":"index.4582e200.js.map"}